2023/10/22
●Introduction

In[]:
from google.cloud import bigquery

# Create a "Client" object
client = bigquery.Client()

# Construct a reference to the "chicago_taxi_trips" dataset
dataset_ref = client.dataset("chicago_taxi_trips", project="bigquery-public-data")

# API request - fetch the dataset
dataset = client.get_dataset(dataset_ref)

1) Find the data

データにアクセスする前に、データのあるテーブル名を見つける必要があります。

In[]:
# List all the tables in the dataset
tables = list(client.list_tables(dataset))

# Print names of all tables in the dataset (there is only one!)
for table in tables:  
    print(table.table_id)

Out[]:
taxi_trips

In[]:
# Write the table name as a string below
table_name = "taxi_trips"

2) Peek at the data

次のコード・セルを使って、データの上位数行を覗いてみる。データを検査し、データ品質に問題があるかどうかすぐにわかるかどうかを確認する。

In[]:
table_ref = dataset_ref.table("taxi_trips")
table = client.get_table(table_ref)
client.list_rows(table, max_results=5).to_dataframe()

Out[]:
5 rows × 23 columns

3) Determine when this data is from

データが十分に古い場合、そのデータが現在の交通パターンにまだ関連性があると仮定する前に注意する必要があります。
各年のトリップ数をカウントするクエリを書いてください。

結果には2つの列があるはずです：

・year - トリップの年
・num_trips - その年のトリップ数。

ヒント：

・GROUP BYとORDER BYを使用する場合、SELECTクエリの先頭で設定した年という別名でカラムを参照する必要があります。
・trip_start_timestampから年をSELECTするSQLコードは、SELECT EXTRACT(YEAR FROM trip_start_timestamp)です。
・FROMフィールドは慣れるまで少し厄介です。書式は以下の通り：
　- バッキック（記号`）。
  - プロジェクト名。この場合はbigquery-public-data。
  - ピリオド。
  - データセット名。この場合、chicago_taxi_trips。
  -  期間。
  -  テーブル名。これは、1) データを検索する で答えとして使用したものです。
  -  バックスティック（記号 `）。



























