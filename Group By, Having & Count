2023/10/14
●Introduction

生データを選択できるようになったので、データをグループ分けし、そのグループ内でカウントする方法を学ぶ準備ができました。
これは、次のような質問に答えるのに役立ちます：

・うちの店は何種類の果物を売ったか？
・動物病院では何種類の動物を治療したか？

そのために、3つの新しいテクニックを学びます： GROUP BY、HAVING、COUNT() です。もう一度、ペットに関する情報を集めたこの作り物の表を使います。

●COUNT()

COUNT()は、その名前から想像がつくかもしれないが、物の数を返す。カラム名を渡すと、そのカラムのエントリ数を返します。

例えば、petsテーブルのIDカラムのCOUNT()をSELECTすると、テーブルには4つのIDがあるので、4が返されます。

''''''''''''
query = SELECT.COUNT(ID)
        FROM `bigquery-public-data.pet_records.pets`
''''''''''''

COUNT() は集約関数の一例であり、多くの値を取って 1 つを返します (他の集約関数の例には SUM(), AVG(), MIN(), MAX() があります)。
(他の集約関数の例としては、SUM()、AVG()、MIN()、MAX()などがある）。
上の図でお気づきのように、集約関数は奇妙なカラム名（f0__など）を使用します。
このチュートリアルの後半で、この名前をよりわかりやすいものに変更する方法を学びます。

●GROUP BY

GROUP BYは、1つまたは複数の列の名前を取り、
COUNT()のような集約関数を適用する際に、その列に同じ値を持つすべての行を1つのグループとして扱います。

例えば、petsテーブルの動物の種類ごとの数を知りたいとします。
GROUP BY を使用して Animal 列に同じ値を持つ行をグループ化し、COUNT() を使用して各グループに含まれる ID の数を調べます。

''''''''''''
query = SELECT Animai,COUNT(ID)
        FROM `bigquery-public-data.pet_records.pets`
        GROUP BY Animal
''''''''''''

これは3つの行（それぞれの動物に1つずつ）を持つテーブルを返す。petsテーブルにはウサギが1匹、犬が1匹、猫が2匹含まれていることがわかる。

●GROUP BY ... HAVING





















